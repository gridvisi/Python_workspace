'''
==========解决方案============

第一种：第一行加:# -*- coding: utf-8 -*-

第二种：引用处设置默认编码格式 　# coding: utf-8

第三种：使用中文处将中文unicode编码
#-*- coding : utf-8 -*-
# coding: utf-8
csv_data = pd.read_csv(csv_file, low_memory=False,encoding='gbk')
————————————————
转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/qq_35892623/article/details/82941473

#http://c.biancheng.net/pandas/dataframe.html

https://pandas.pydata.org/docs/user_guide/index.html
'''

#-*- coding : utf-8 -*-
# coding: utf-8

import pandas as pd












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































csv_file = "d:\\data_science\\bookmis\\bookeng.csv"
csv_data = pd.read_csv(csv_file, low_memory=False,encoding='gbk')  # 防止弹出警告
#print([csv_data[i] for i in ['name','booth']])
print(csv_data.loc[:,['name','price']])

for name in csv_data['name']:
    if name == '水许传':
        print(name,csv_data['booth'])

csv_df = pd.DataFrame(csv_data)
print(csv_df)
books = csv_df
bookshelf = csv_df
print(bookshelf['booth'])
print(bookshelf.values)
print(bookshelf.loc['name':'好词好句'])
print("$$$$$$$$$$ value $$$$$$$$$$$$$")

bkf = pd.Series(bookshelf['name'])
print(bkf)
# booth	  name	  publisher	author	price	stock
# ["书号", "书名", "出版社", "作者", "价格", "库存"]

# 书的属性：书名，作者，状态，位置
# 管理系统：
class Book(object):  # 定义一个书类

    def __init__(self, booth,name,publisher,status,author,price,stock):
        self.booth = booth
        self.name = name
        #self.author = author
        self.publisher = publisher
        self.status = status
        self.author = author
        self.price = price
        self.stock = stock


    def __str__(self):
        if self.status == 1:
            stats = '未借出'
        elif self.status == 0:
            stats = '已借出'
        else:
            stats = '状态异常'
        return '书名: 《%s》 作者: %s 状态: <%s> 位置: %s' \
               % (self.name, self.author, stats, self.booth)


class BookManage(object):
    books = []
    bookshelf = csv_df
    def start(self):
        # 添加图书
        # num, name, author, publish,status,price,stock,bookindex
        '''

        self.books.append(Book('python', 'guido', 1, 'ISO9001'))
        self.books.append(Book('c', '谭浩强', 1, 'NFS8102'))
        self.books.append(Book('java', 'westos', 1, 'PKA7844'))
        :return:
        '''
        # 0:借出 1：存在
        # python 1
        # c 1
        # java 1

    def Menu(self):
        self.start()
        while True:
            print("""
                        图书管理系统
        1.查询图书
        2.增加图书
        3.借阅图书
        4.归还图书
        5.退出系统
        """)

            choice = input('请选择：')

            if choice == '1':
                print('["书号", "书名", "出版社", "作者", "价格", "库存"]')
                self.showAllBook()  # 调用显示所有书籍的函数

            elif choice == '2':
                self.addBook()  # 调用添加书籍的函数

            elif choice == '3':
                self.borrowBook()  # 调用借书的函数

            elif choice == '4':
                self.returnBook()  # 调用还书的函数

            elif choice == '5':
                print('欢迎下次使用...')
                exit()
            else:
                print('请输入正确选择')
                continue



    def showAllBook(self):
        print(books)
        for book in self.books:
            print(book)


    def addBook(self):
        name = input('图书名称:')
        self.books.append(Book(name, input('作者:'), 1, input('存储位置:')))
        print('图书《%s》增加成功' % name)


    def checkBook(self, name, bookshelf):
        '''

        for book in self.books:
            if book.name == name:
            return book
        else:
            return None
        :param self:
        :param name:
        :return:
        '''
        #name = input("输入书名：")
        bool_in = 0
        if name in bookshelf['name']:
            print(f"库存里有《{name}》在bookshelf")
            bool_in = not bool_in

        elif name not in bookshelf:
            for book in bookshelf:
                if name in book:
                    print("你找的是不是: ", f"《{book}》在bookshelf里面，\n"
                            f"你需要借这本书吗？")
                    userkey = input("确认借输入Y，否则N:")
                    if userkey == 'Y':
                        bool_in = not bool_in
                    else:pass
        return bool_in   #库里是否有书，会员是否决定借


    def borrowBook(self):
        name = input('借阅图书名称: ')
        # self.checkBook(name,bookshelf)
        print(self.checkBook(name,bookshelf))
        # 判断书是否存在，如果存在，判断书是否已借出，如果没有借出，借阅并将其状态改为0
        if self.checkBook(name,bookshelf):
            if Book(name).stock == 0:
                print('书籍《%s》已经借出' % name)
            elif Book(name).stock > 1:
                print('书籍《%s》借阅成功' % name)
        else:
            print('书籍《%s》不存在' % name)


    def returnBook(self):
        name = input('归还图书名称:')
        ret = self.checkBook(name,bookshelf)

        if ret != None:
            if ret.status == 0:
                ret.status = 1
                print('书籍《%s》归还成功' % name)
                print(ret)
            else:
                print('书籍《%s》未借出' % name)
        else:
            print('书籍《%s》不存在' % name)


manager = BookManage()  # 类的实例化
manager.Menu()